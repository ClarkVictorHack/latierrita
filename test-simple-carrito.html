<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple - Carrito</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .test-button {
            background-color: #d79f49 !important;
            color: white !important;
            padding: 12px 24px !important;
            border-radius: 8px !important;
            border: none !important;
            cursor: pointer !important;
            font-weight: bold !important;
        }
        .test-button:hover {
            opacity: 0.9 !important;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <h1 class="text-3xl font-bold mb-6">Test Simple del Carrito</h1>
    
    <!-- Test manual de productos -->
    <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
        <h2 class="text-xl font-semibold mb-4">Test Manual</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="border p-4 rounded">
                <h3 class="font-bold">Mini Bol√≥n de Verde</h3>
                <p class="text-gray-600 mb-2">$3.50</p>
                <button class="test-button" onclick="testAgregarProducto(3)">
                    <i class="fas fa-shopping-cart mr-2"></i>
                    Agregar al Carrito
                </button>
            </div>
            <div class="border p-4 rounded">
                <h3 class="font-bold">Mini Muchin de Yuca</h3>
                <p class="text-gray-600 mb-2">$3.50</p>
                <button class="test-button" onclick="testAgregarProducto(1)">
                    <i class="fas fa-shopping-cart mr-2"></i>
                    Agregar al Carrito
                </button>
            </div>
        </div>
    </div>
    
    <!-- Mostrar carrito -->
    <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
        <h2 class="text-xl font-semibold mb-4">Estado del Carrito</h2>
        <div id="cart-display">
            <p>Cargando...</p>
        </div>
        <button class="bg-blue-500 text-white px-4 py-2 rounded mt-4" onclick="actualizarDisplay()">
            Actualizar Display
        </button>
    </div>
    
    <!-- Contenedor para productos autom√°ticos -->
    <div class="bg-white p-6 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Productos Autom√°ticos</h2>
        <div id="product-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- Los productos se cargar√°n aqu√≠ -->
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Variables globales para test
        let testCarrito = [];
        
        // Productos simplificados para test
        const testProductos = [
            {
                id: 1,
                nombre: "Mini Muchin de Yuca",
                precio: 3.50,
                imagen: "img/mini muchin.png"
            },
            {
                id: 3,
                nombre: "Mini Bol√≥n de Verde",
                precio: 3.50,
                imagen: "img/mini bolon de verde.png"
            }
        ];
        
        // Funci√≥n de test para agregar productos
        function testAgregarProducto(id) {
            console.log('üß™ Test: Agregando producto con ID:', id);
            
            const producto = testProductos.find(p => p.id === id);
            if (!producto) {
                console.error('‚ùå Producto no encontrado:', id);
                return;
            }
            
            console.log('‚úÖ Producto encontrado:', producto);
            
            const existente = testCarrito.find(item => item.id === id);
            if (existente) {
                existente.cantidad += 1;
                console.log('üìà Cantidad actualizada:', existente);
            } else {
                testCarrito.push({
                    id: producto.id,
                    nombre: producto.nombre,
                    precio: producto.precio,
                    cantidad: 1
                });
                console.log('‚ûï Producto agregado al carrito');
            }
            
            actualizarDisplay();
            mostrarNotificacion(producto.nombre);
        }
        
        // Actualizar display del carrito
        function actualizarDisplay() {
            const display = document.getElementById('cart-display');
            if (testCarrito.length === 0) {
                display.innerHTML = '<p class="text-gray-500">Carrito vac√≠o</p>';
            } else {
                const total = testCarrito.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
                display.innerHTML = `
                    <div class="space-y-2">
                        ${testCarrito.map(item => `
                            <div class="flex justify-between items-center p-2 border rounded">
                                <span>${item.nombre} x${item.cantidad}</span>
                                <span class="font-bold">$${(item.precio * item.cantidad).toFixed(2)}</span>
                            </div>
                        `).join('')}
                        <div class="border-t pt-2 font-bold text-lg">
                            Total: $${total.toFixed(2)}
                        </div>
                    </div>
                `;
            }
        }
        
        // Mostrar notificaci√≥n
        function mostrarNotificacion(nombreProducto) {
            const notif = document.createElement('div');
            notif.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
            notif.innerHTML = `
                <div class="flex items-center space-x-2">
                    <i class="fas fa-check-circle"></i>
                    <span>${nombreProducto} agregado</span>
                </div>
            `;
            document.body.appendChild(notif);
            
            setTimeout(() => {
                notif.remove();
            }, 3000);
        }
        
        // Renderizar productos autom√°ticamente
        function renderTestProducts() {
            const container = document.getElementById('product-list');
            container.innerHTML = testProductos.map(producto => `
                <div class="bg-gray-50 p-4 rounded-lg border">
                    <h3 class="font-bold mb-2">${producto.nombre}</h3>
                    <p class="text-gray-600 mb-3">$${producto.precio.toFixed(2)}</p>
                    <button class="test-button w-full" onclick="testAgregarProducto(${producto.id})">
                        <i class="fas fa-shopping-cart mr-2"></i>
                        Agregar al Carrito
                    </button>
                </div>
            `).join('');
        }
        
        // Inicializar cuando la p√°gina cargue
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Test page loaded');
            actualizarDisplay();
            renderTestProducts();
        });
    </script>
    
    <!-- Cargar el script principal despu√©s para comparar -->
    <script>
        // Intentar cargar el script principal despu√©s de un delay
        setTimeout(() => {
            const script = document.createElement('script');
            script.src = 'main.js';
            script.onload = () => {
                console.log('üìÑ Script principal cargado');
                console.log('üîç Comparando funciones...');
                console.log('agregarAlCarrito definida:', typeof agregarAlCarrito !== 'undefined');
                console.log('productos definidos:', typeof productos !== 'undefined');
                console.log('carrito definido:', typeof carrito !== 'undefined');
            };
            script.onerror = () => {
                console.error('‚ùå Error cargando script principal');
            };
            document.head.appendChild(script);
        }, 1000);
    </script>
</body>
</html>
