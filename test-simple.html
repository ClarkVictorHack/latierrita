<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple La Tierrita</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">Test Simple - Carrito La Tierrita</h1>
        
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold mb-4">Prueba Directa</h2>
            <button onclick="testDirecto()" class="bg-blue-500 text-white px-4 py-2 rounded mb-4">
                Test FunciÃ³n Directa
            </button>
            
            <div class="border p-4 rounded">
                <h3 class="font-bold mb-2">Mini BolÃ³n de Verde - $3.50</h3>
                <button onclick="testAgregarCarrito(3)" class="bg-orange-500 text-white px-4 py-2 rounded">
                    Agregar al Carrito (ID: 3)
                </button>
            </div>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow">
            <h2 class="text-lg font-semibold mb-4">Resultados</h2>
            <div id="resultados" class="space-y-2 text-sm"></div>
        </div>
    </div>

    <script>
        // Definir productos localmente para test
        const productos = [
            {
                id: 3,
                nombre: "Mini BolÃ³n de Verde",
                categoria: "Bocaditos Tradicionales",
                imagen: "img/mini bolon de verde.png",
                descripcion: "Deliciosas bolitas de queso hechas con plÃ¡tano cocinadas a la perfecciÃ³n.",
                precio: 3.50,
                peso: "500g",
                ingredientes: "PlÃ¡tano, leche, sal, hierbita y queso."
            }
        ];
        
        let carrito = JSON.parse(localStorage.getItem('cart')) || [];
        
        function agregarAlCarrito(productoId) {
            console.log('ðŸ›’ agregarAlCarrito llamado con ID:', productoId);
            
            const producto = productos.find(p => p.id === productoId);
            if (!producto) {
                console.error('âŒ Producto no encontrado:', productoId);
                mostrarResultado('âŒ Producto no encontrado: ' + productoId, 'error');
                return;
            }
            
            console.log('âœ… Producto encontrado:', producto);
            mostrarResultado('âœ… Producto encontrado: ' + producto.nombre, 'success');
            
            const itemExistente = carrito.find(item => item.id === productoId);
            if (itemExistente) {
                itemExistente.cantidad += 1;
                mostrarResultado('ðŸ“ˆ Cantidad actualizada: ' + itemExistente.cantidad, 'info');
            } else {
                const nuevoItem = {
                    id: producto.id,
                    nombre: producto.nombre,
                    precio: parseFloat(producto.precio),
                    imagen: producto.imagen,
                    cantidad: 1
                };
                carrito.push(nuevoItem);
                mostrarResultado('âž• Nuevo item agregado: ' + nuevoItem.nombre, 'success');
            }
            
            localStorage.setItem('cart', JSON.stringify(carrito));
            mostrarResultado('ðŸ’¾ Carrito guardado. Total items: ' + carrito.length, 'info');
        }
        
        function testDirecto() {
            mostrarResultado('ðŸ§ª Test directo iniciado', 'info');
            mostrarResultado('ðŸ“¦ Productos disponibles: ' + productos.length, 'info');
            mostrarResultado('ðŸ›’ Items en carrito: ' + carrito.length, 'info');
        }
        
        function testAgregarCarrito(id) {
            mostrarResultado('ðŸ§ª Test agregar al carrito ID: ' + id, 'info');
            agregarAlCarrito(id);
        }
        
        function mostrarResultado(mensaje, tipo) {
            const resultados = document.getElementById('resultados');
            const div = document.createElement('div');
            
            let clase = 'text-gray-600';
            if (tipo === 'success') clase = 'text-green-600';
            if (tipo === 'error') clase = 'text-red-600';
            if (tipo === 'info') clase = 'text-blue-600';
            
            div.className = clase;
            div.textContent = new Date().toLocaleTimeString() + ': ' + mensaje;
            resultados.appendChild(div);
            
            console.log(mensaje);
        }
        
        // Test inicial
        document.addEventListener('DOMContentLoaded', function() {
            mostrarResultado('ðŸš€ PÃ¡gina cargada', 'success');
            testDirecto();
        });
    </script>
</body>
</html>
